// XFAIL: affine value tracking in multi-shot handlers not yet enforced
// Test: affine value captured in deep (multi-shot) handler should fail (E0310)
effect Choice {
    op choose() -> bool;
}

fn main() -> i32 {
    let x: @affine i32 = 42;
    with Choice {
        op choose() -> bool { resume(true) }
    } do {
        if perform Choice.choose() { x } else { x }
    }
}
